import{r as o,s as g,j as e}from"./index-DEGvuL9T.js";const d={MYDAY:"myday",CREATE:"create",UPDATE:"update"};function ye(){var ae;const[n,D]=o.useState(null),[B,P]=o.useState([]),[M,A]=o.useState([]),[S,E]=o.useState([]),[U,C]=o.useState(!0),[p,y]=o.useState(!1),[de,_]=o.useState(!1),[N,w]=o.useState(null),[le,Q]=o.useState(!1),[K,W]=o.useState(!1),[c,b]=o.useState(d.MYDAY),[r,Y]=o.useState({subject:"",sender:"",body:"",start:null,end:null,isAppointment:!1,messageId:""}),[m,x]=o.useState({title:"",description:"",project_id:"",status:"todo",critical:!1,due_date:""}),[O,ce]=o.useState(""),[h,I]=o.useState(null),[H,R]=o.useState(""),[$,X]=o.useState(null);o.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("mode");s==="myday"?b(d.MYDAY):s==="create"?b(d.CREATE):s==="update"&&b(d.UPDATE)},[]),o.useEffect(()=>{(()=>{if(typeof Office<"u"){W(!0);return}const s=document.createElement("script");s.src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",s.onload=()=>W(!0),s.onerror=()=>W(!0),document.head.appendChild(s)})()},[]),o.useEffect(()=>{if(!K)return;(()=>{typeof Office<"u"&&Office.onReady?Office.onReady(s=>{if(Q(!0),s.host===Office.HostType.Outlook){const i=Office.context.mailbox.item;i&&me(i)}}):Q(!0)})()},[K]);const me=t=>{var a,l,j,ne,oe;if(t.itemType===((l=(a=Office.MailboxEnums)==null?void 0:a.ItemType)==null?void 0:l.Appointment))if(typeof t.subject=="object"&&t.subject.getAsync)t.subject.getAsync(f=>{const u=f.status===Office.AsyncResultStatus.Succeeded?f.value:"";t.start.getAsync(T=>{const v=T.status===Office.AsyncResultStatus.Succeeded?T.value:null;t.end.getAsync(L=>{const G=L.status===Office.AsyncResultStatus.Succeeded?L.value:null;Y({subject:u,sender:"",body:"",start:v,end:G,isAppointment:!0,messageId:""}),x(J=>({...J,title:u,due_date:v?new Date(v).toISOString().split("T")[0]:""}))})})});else{const f=t.subject||"",u=t.start,T=t.end;Y({subject:f,sender:"",body:"",start:u,end:T,isAppointment:!0,messageId:""}),x(v=>({...v,title:f,due_date:u?new Date(u).toISOString().split("T")[0]:""}))}else{const f=t.subject||"",u=((j=t.from)==null?void 0:j.displayName)||((ne=t.from)==null?void 0:ne.emailAddress)||"",T=((oe=t.from)==null?void 0:oe.emailAddress)||"",v=t.internetMessageId||"";t.body.getAsync(Office.CoercionType.Text,L=>{if(L.status===Office.AsyncResultStatus.Succeeded){const G=L.value||"";Y({subject:f,sender:u,body:G,start:null,end:null,isAppointment:!1,messageId:v}),x(J=>({...J,title:f,description:`From: ${u} <${T}>`}))}})}};o.useEffect(()=>{(async()=>{C(!0);try{const{data:{session:s}}=await g.auth.getSession();s!=null&&s.user&&(D(s.user),await Z())}catch(s){console.error("Init error:",s)}C(!1)})()},[]),o.useEffect(()=>{n&&c===d.MYDAY?k():n&&(c===d.UPDATE||c===d.CREATE)&&q()},[c,n]);const Z=async()=>{const{data:t}=await g.from("projects").select("*").order("created_at",{ascending:!1});t&&t.length>0&&(P(t),x(s=>({...s,project_id:t[0].id}))),await k(),await q()},k=async()=>{try{const t=new Date().toISOString().split("T")[0],{data:s,error:i}=await g.from("tasks").select("*, projects(name)").or(`my_day_date.eq.${t},due_date.eq.${t}`).neq("status","done").order("critical",{ascending:!1}).order("due_date",{ascending:!0});!i&&s&&A(s)}catch(t){console.error("loadMyDayTasks error:",t)}},q=async()=>{try{const{data:t,error:s}=await g.from("tasks").select("*, projects(name)").neq("status","done").order("updated_at",{ascending:!1}).limit(100);!s&&t&&E(t)}catch(t){console.error("loadAllTasks error:",t)}},xe=async t=>{t.preventDefault(),w(null),y(!0);const s=new FormData(t.target),i=s.get("email"),a=s.get("password"),{data:l,error:j}=await g.auth.signInWithPassword({email:i,password:a});if(j){w(j.message),y(!1);return}D(l.user),await Z(),y(!1)},ue=async t=>{var s,i;t.preventDefault(),y(!0),w(null);try{let a="";if(r.isAppointment)a=`Meeting: ${r.subject}
Date: ${r.start?new Date(r.start).toLocaleString():"N/A"}`;else{const j=((s=r.body)==null?void 0:s.substring(0,500))||"";a=`Email from: ${r.sender}
Subject: ${r.subject}

${j}${((i=r.body)==null?void 0:i.length)>500?"...":""}`}const{error:l}=await g.from("tasks").insert({title:m.title,description:m.description,project_id:m.project_id,status:m.status,critical:m.critical,due_date:m.due_date||null,source:r.isAppointment?"meeting":"email",source_link:r.messageId||null,notes:a,energy_level:"medium"});if(l)throw l;_(!0),await k()}catch(a){w(a.message)}finally{y(!1)}},ge=async()=>{if(h){y(!0),w(null);try{let s=`

--- ${new Date().toLocaleString()} ---
`;r.isAppointment?s+=`ðŸ“… Meeting: ${r.subject}
`:s+=`ðŸ“§ Email from: ${r.sender}
Subject: ${r.subject}
`,H.trim()&&(s+=`
${H.trim()}`);const i=(h.notes||"")+s,{error:a}=await g.from("tasks").update({notes:i,updated_at:new Date().toISOString()}).eq("id",h.id);if(a)throw a;_(!0),I(null),R(""),await k(),await q()}catch(t){w(t.message)}finally{y(!1)}}},ee=async t=>{const s=t.status==="done"?"todo":"done",{error:i}=await g.from("tasks").update({status:s}).eq("id",t.id);i||A(s==="done"?a=>a.filter(l=>l.id!==t.id):a=>a.map(l=>l.id===t.id?{...l,status:s}:l))},te=async t=>{const s=new Date().toISOString().split("T")[0],a=t.my_day_date===s?null:s,{error:l}=await g.from("tasks").update({my_day_date:a}).eq("id",t.id);l||await k()},pe=()=>{_(!1),I(null),R(""),x(t=>({...t,title:r.subject||"",description:r.sender?`From: ${r.sender}`:"",critical:!1,due_date:""}))},se=t=>{if(!t)return"";const s=new Date(t),i=new Date,a=new Date(i);return a.setDate(a.getDate()+1),t===i.toISOString().split("T")[0]?"Today":t===a.toISOString().split("T")[0]?"Tomorrow":s.toLocaleDateString("en-GB",{day:"numeric",month:"short"})},he=()=>new Date().toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"}),re=O.trim()?S.filter(t=>{var s,i;return t.title.toLowerCase().includes(O.toLowerCase())||((i=(s=t.projects)==null?void 0:s.name)==null?void 0:i.toLowerCase().includes(O.toLowerCase()))}):S.slice(0,10);if(U||!le)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]})});if(!n)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50 p-4",children:[e.jsxs("div",{className:"text-center mb-6 pt-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center mx-auto mb-3",children:e.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Trackli"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Track. Manage. Deliver."})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[N&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-700",children:N}),e.jsxs("form",{onSubmit:xe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"you@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",name:"password",required:!0,className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full py-2.5 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl hover:from-indigo-600 hover:to-purple-600 transition-all font-medium text-sm disabled:opacity-50",children:p?"Signing in...":"Sign In"})]})]})]});if(de)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:c===d.UPDATE?"Task Updated!":"Task Created!"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:c===d.UPDATE?"Note added successfully":"Added to Trackli"}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("button",{onClick:()=>{b(d.MYDAY),_(!1)},className:"px-4 py-2.5 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-all font-medium text-sm",children:"View My Day"}),e.jsx("button",{onClick:pe,className:"px-4 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl hover:from-indigo-600 hover:to-purple-600 transition-all font-medium text-sm",children:c===d.UPDATE?"Update Another":"Create Another"})]})]})});const V=new Date().toISOString().split("T")[0],z=M.filter(t=>t.my_day_date===V),F=M.filter(t=>t.due_date===V&&t.my_day_date!==V);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-indigo-50 flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-3 pt-3 pb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),e.jsx("span",{className:"font-bold text-gray-800 text-sm",children:"Trackli"})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>b(d.MYDAY),className:`flex items-center gap-1 px-3 py-2 text-xs font-medium rounded-t-lg transition-colors ${c===d.MYDAY?"bg-gradient-to-br from-slate-50 to-indigo-50 text-indigo-600 border-t border-l border-r border-gray-200":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),"My Day"]}),e.jsxs("button",{onClick:()=>b(d.CREATE),className:`flex items-center gap-1 px-3 py-2 text-xs font-medium rounded-t-lg transition-colors ${c===d.CREATE?"bg-gradient-to-br from-slate-50 to-indigo-50 text-indigo-600 border-t border-l border-r border-gray-200":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create"]}),e.jsxs("button",{onClick:()=>b(d.UPDATE),className:`flex items-center gap-1 px-3 py-2 text-xs font-medium rounded-t-lg transition-colors ${c===d.UPDATE?"bg-gradient-to-br from-slate-50 to-indigo-50 text-indigo-600 border-t border-l border-r border-gray-200":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Update"]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c===d.MYDAY&&e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"My Day"}),e.jsx("p",{className:"text-sm text-gray-500",children:he()})]}),M.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-100 flex items-center justify-center mx-auto mb-3",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"No tasks for today"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Add tasks to My Day in Trackli"})]}):e.jsxs("div",{className:"space-y-4",children:[z.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-indigo-600 uppercase tracking-wide",children:"My Day"}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",z.length,")"]})]}),e.jsx("div",{className:"space-y-2",children:z.map(t=>e.jsx(ie,{task:t,expanded:$===t.id,onToggleExpand:()=>X($===t.id?null:t.id),onToggleComplete:ee,onToggleMyDay:te,formatDate:se},t.id))})]}),F.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-amber-600 uppercase tracking-wide",children:"Due Today"}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",F.length,")"]})]}),e.jsx("div",{className:"space-y-2",children:F.map(t=>e.jsx(ie,{task:t,expanded:$===t.id,onToggleExpand:()=>X($===t.id?null:t.id),onToggleComplete:ee,onToggleMyDay:te,formatDate:se},t.id))})]})]}),e.jsxs("button",{onClick:k,className:"mt-4 w-full py-2 text-sm text-indigo-600 hover:text-indigo-700 font-medium flex items-center justify-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),c===d.CREATE&&e.jsxs("div",{className:"p-4",children:[r.subject&&e.jsxs("div",{className:"mb-4 p-3 bg-white rounded-xl border border-gray-200",children:[e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:r.isAppointment?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})," Meeting"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})," Email from ",r.sender]})}),e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:r.subject})]}),N&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-700",children:N}),e.jsxs("form",{onSubmit:ue,className:"bg-white rounded-xl p-4 shadow-sm space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title"}),e.jsx("input",{type:"text",required:!0,value:m.title,onChange:t=>x(s=>({...s,title:t.target.value})),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",placeholder:"What needs to be done?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),e.jsx("select",{value:m.project_id,onChange:t=>x(s=>({...s,project_id:t.target.value})),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",children:B.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:m.due_date,onChange:t=>x(s=>({...s,due_date:t.target.value})),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:m.status,onChange:t=>x(s=>({...s,status:t.target.value})),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"backlog",children:"Backlog"}),e.jsx("option",{value:"todo",children:"To Do"}),e.jsx("option",{value:"in_progress",children:"In Progress"})]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.critical,onChange:t=>x(s=>({...s,critical:t.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"ðŸš© Critical Task"})]})}),e.jsx("button",{type:"submit",disabled:p||!m.title||!m.project_id,className:"w-full py-2.5 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl hover:from-indigo-600 hover:to-purple-600 transition-all font-medium text-sm disabled:opacity-50",children:p?"Creating...":"Create Task"})]})]}),c===d.UPDATE&&e.jsxs("div",{className:"p-4",children:[r.subject&&e.jsxs("div",{className:"mb-4 p-3 bg-white rounded-xl border border-gray-200",children:[e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:r.isAppointment?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})," Meeting"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})," Email from ",r.sender]})}),e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:r.subject})]}),N&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-700",children:N}),h?e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800",children:"Adding note to:"}),e.jsx("button",{onClick:()=>I(null),className:"text-xs text-indigo-600 hover:text-indigo-700",children:"Change"})]}),e.jsxs("div",{className:"p-3 bg-indigo-50 rounded-lg mb-4",children:[e.jsxs("p",{className:"text-sm font-medium text-indigo-900",children:[h.critical&&e.jsx("span",{className:"text-red-500 mr-1",children:"ðŸš©"}),h.title]}),((ae=h.projects)==null?void 0:ae.name)&&e.jsx("span",{className:"text-xs text-indigo-600",children:h.projects.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Add a note (optional)"}),e.jsx("textarea",{value:H,onChange:t=>R(t.target.value),placeholder:"Add any additional context...",rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm resize-none"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["The ",r.isAppointment?"meeting":"email"," details will be automatically attached."]}),e.jsx("button",{onClick:ge,disabled:p,className:"w-full py-2.5 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl hover:from-indigo-600 hover:to-purple-600 transition-all font-medium text-sm disabled:opacity-50",children:p?"Updating...":"Update Task"})]}):e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select a task to update"}),e.jsx("input",{type:"text",value:O,onChange:t=>ce(t.target.value),placeholder:"Search tasks...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm mb-3"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:re.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No tasks found"}):re.map(t=>{var s;return e.jsxs("button",{onClick:()=>I(t),className:"w-full p-3 rounded-lg border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50/50 transition-colors text-left",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-800 truncate",children:[t.critical&&e.jsx("span",{className:"text-red-500 mr-1",children:"ðŸš©"}),t.title]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[((s=t.projects)==null?void 0:s.name)&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full bg-indigo-100 text-indigo-600",children:t.projects.name}),e.jsx("span",{className:"text-xs text-gray-400",children:t.status.replace("_"," ")})]})]},t.id)})})]})]})]})]})}function ie({task:n,expanded:D,onToggleExpand:B,onToggleComplete:P,onToggleMyDay:M,formatDate:A}){var C;const S=new Date().toISOString().split("T")[0],E=n.my_day_date===S,U=n.due_date&&n.due_date<S;return e.jsxs("div",{className:`bg-white rounded-xl shadow-sm border transition-all ${n.critical?"border-l-4 border-l-red-500 border-gray-200":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 cursor-pointer",onClick:B,children:[e.jsx("button",{onClick:p=>{p.stopPropagation(),P(n)},className:`mt-0.5 w-5 h-5 rounded-full border-2 flex-shrink-0 flex items-center justify-center transition-colors ${n.status==="done"?"bg-green-500 border-green-500 text-white":"border-gray-300 hover:border-indigo-500"}`,children:n.status==="done"&&e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:`text-sm font-medium ${n.status==="done"?"line-through text-gray-400":"text-gray-800"}`,children:[n.critical&&e.jsx("span",{className:"text-red-500 mr-1",children:"ðŸš©"}),n.title]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[((C=n.projects)==null?void 0:C.name)&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full bg-indigo-100 text-indigo-600",children:n.projects.name}),n.due_date&&e.jsx("span",{className:`text-xs ${U?"text-red-500 font-medium":"text-gray-400"}`,children:A(n.due_date)})]})]}),e.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${D?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),D&&e.jsx("div",{className:"px-3 pb-3 pt-0 border-t border-gray-100",children:e.jsxs("div",{className:"pt-2 space-y-2",children:[n.description&&e.jsx("p",{className:"text-xs text-gray-500",children:n.description}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>M(n),className:`flex items-center gap-1 text-xs px-2 py-1 rounded-lg transition-colors ${E?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),E?"In My Day":"Add to My Day"]})})]})})]})}export{ye as default};
